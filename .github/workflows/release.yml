name: Release

on:
  pull_request:
    types:
      - opened
      - edited
      - synchronize
      - labeled
      - unlabeled
  push:
    branches:
      - "version/*"
      - "release/*"
      - "testing/*"

permissions:
  contents: write
  statuses: write

jobs:
  release:
    uses: Thodor12/operapublicacreator/.github/workflows/gradle.publish.yaml@fix/changelog-merging
    with:
      java: 21
      curse_release_type: ${{ contains(github.ref, 'release') && 'release' || 'beta' }}
      gradle_tasks: assemble
    secrets:
      DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
      MAVEN_USER: ${{ secrets.MAVEN_USER }}
      MAVEN_PASSWORD: ${{ secrets.MAVEN_PASSWORD }}
      CURSE_API_KEY: ${{ secrets.CURSE_API_KEY }}
      CROWDIN_API_KEY: ${{ secrets.CROWDIN_API_KEY }}
      GRADLE_ENCRYPTION_KEY: ${{ secrets.GRADLE_ENCRYPTION_KEY }}